---
export interface Props {
  title: string;
  description?: string;
  image?: string;
}

const { title, description = "Doctor-led telehealth that actually fits real life. We help with medical weight management and metabolic healthâ€”starting with a proper check, clear targets, and regular reviews.", image = "/og-image.jpg" } = Astro.props;

const canonicalURL = Astro.site ? new URL(Astro.url.pathname, Astro.site) : Astro.url;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={Astro.url} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={new URL(image, Astro.site || Astro.url)} />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={Astro.url} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={new URL(image, Astro.site || Astro.url)} />
    
    <title>{title} | Vital Health NZ</title>
    
    <!-- Schema.org structured data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "MedicalOrganization",
        "name": "Vital Health NZ",
        "alternateName": "Vital Health New Zealand",
        "url": "https://vitalhealth.nz",
        "logo": "https://vitalhealth.nz/images/logos/Vital-Health-Logo.png",
        "image": "https://vitalhealth.nz/images/logos/Vital-Health-Logo.png",
        "description": "Doctor-led telehealth services in New Zealand specializing in medical weight management and metabolic health assessment. MCNZ registered doctors providing lifestyle medicine and medical assessment.",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Dunedin",
          "addressRegion": "Otago",
          "addressCountry": "NZ"
        },
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": -36.8485,
          "longitude": 174.7633
        },
        "areaServed": [
          {
            "@type": "Country",
            "name": "New Zealand"
          },
          {
            "@type": "City",
            "name": "Dunedin"
          },
          {
            "@type": "City", 
            "name": "Wellington"
          },
          {
            "@type": "City",
            "name": "Christchurch"
          },
          {
            "@type": "City",
            "name": "Hamilton"
          },
          {
            "@type": "City",
            "name": "Tauranga"
          }
        ],

        "medicalSpecialty": [
          "Weight Management",
          "Endocrinology", 
          "Preventive Medicine",
          "Telemedicine",
          "Lifestyle Medicine"
        ],
        "serviceType": [
          "Telehealth Consultations",
          "Weight Management Services",
          "Medical Weight Management",
          "Metabolic Health Assessment",
          "Lifestyle Medicine"
        ],
        "priceRange": "$$",
        "paymentAccepted": ["Credit Card", "Bank Transfer"],
        "currenciesAccepted": "NZD",
        "hasOfferCatalog": {
          "@type": "OfferCatalog",
          "name": "Medical Services",
          "itemListElement": [
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "MedicalTherapy",
                "name": "Medical Weight Management with Lifestyle Medicine Support",
                "description": "Online prescription services for medical weight management with lifestyle medicine support and comprehensive health coaching"
              },
              "price": "120",
              "priceCurrency": "NZD",
              "availability": "https://schema.org/InStock"
            },
            {
              "@type": "Offer", 
              "itemOffered": {
                "@type": "MedicalTherapy",
                "name": "Weight Management Program",
                "description": "Comprehensive medical weight management with lifestyle coaching and medication when appropriate"
              },
              "price": "120",
              "priceCurrency": "NZD",
              "availability": "https://schema.org/InStock"
            }
          ]
        },
        "sameAs": [
          "https://www.facebook.com/vitalhealthnz",
          "https://www.linkedin.com/company/vital-health-nz"
        ]
      }
    </script>
    
    <!-- Geo-targeting -->
    <meta name="geo.region" content="NZ" />
    <meta name="geo.placename" content="New Zealand" />
    <meta name="geo.position" content="-40.9006;174.8860" />
    <meta name="ICBM" content="-40.9006, 174.8860" />
    
    <!-- Preload fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
              <!-- Security headers -->
          <meta http-equiv="X-Content-Type-Options" content="nosniff">
          <meta http-equiv="X-Frame-Options" content="DENY">
          <meta http-equiv="X-XSS-Protection" content="1; mode=block">
          
          <!-- Medical compliance -->
          <meta name="robots" content="index, follow">
          <meta name="author" content="Vital Health NZ">
          <meta name="keywords" content="telehealth, weight management, medical weight management, metabolic health, New Zealand, online doctor, lifestyle medicine">
          
          <!-- Additional SEO -->
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <meta name="theme-color" content="#1e40af">
          <meta name="msapplication-TileColor" content="#1e40af">
          
          <!-- Preconnect to external domains for performance -->
          <link rel="preconnect" href="https://fonts.googleapis.com">
          <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  </head>
  <body>
    <slot />
    
    <!-- Cookie Consent Banner -->
    <div id="cookie-consent" class="fixed bottom-0 left-0 right-0 bg-neutral-900 text-white p-4 z-50 hidden">
      <div class="container-max flex flex-col md:flex-row items-center justify-between gap-4">
        <div class="text-sm">
          <p>We use cookies to improve your experience and analyze site usage. By continuing to use our site, you consent to our use of cookies. 
          <a href="/cookie-policy" class="text-accent-400 hover:text-accent-300 underline">Learn more</a></p>
        </div>
        <div class="flex gap-2">
          <button id="cookie-accept" class="bg-accent-600 hover:bg-accent-700 text-white px-4 py-2 rounded text-sm">
            Accept
          </button>
          <button id="cookie-decline" class="bg-neutral-700 hover:bg-neutral-600 text-white px-4 py-2 rounded text-sm">
            Decline
          </button>
        </div>
      </div>
    </div>

    <script>
      // Cookie consent functionality
      document.addEventListener('DOMContentLoaded', function() {
        const cookieConsent = document.getElementById('cookie-consent');
        const acceptBtn = document.getElementById('cookie-accept');
        const declineBtn = document.getElementById('cookie-decline');
        
        // Check if consent has been given
        if (!localStorage.getItem('cookieConsent')) {
          cookieConsent.classList.remove('hidden');
        }
        
        acceptBtn.addEventListener('click', function() {
          localStorage.setItem('cookieConsent', 'accepted');
          cookieConsent.classList.add('hidden');
        });
        
        declineBtn.addEventListener('click', function() {
          localStorage.setItem('cookieConsent', 'declined');
          cookieConsent.classList.add('hidden');
        });
      });
    </script>
  </body>
</html>

<style is:global>
  @import '../styles/global.css';
</style>
